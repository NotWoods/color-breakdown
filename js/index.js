function e(e){const t=e.target;var o;o=t.src,"blob:"===new URL(o).protocol&&URL.revokeObjectURL(o)}const t=navigator.clipboard||import("./clipboard-polyfill-7a6df023.js");function o(e){switch(e.colorTextType){case"RGB":case"HSL":const t=function(e){let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(null==t)return;return[t[1],t[2],t[3]].map(e=>parseInt(e,16))}(e.hexColor);if(null==t)return e.hexColor;const[o,a,r]=t;if("RGB"===e.colorTextType)return`R${o} G${a} B${r}`;const[n,c,i]=function(e,t,o){e/=255,t/=255,o/=255;let a,r,n=Math.max(e,t,o),c=Math.min(e,t,o),i=(n+c)/2;if(n===c)a=r=0;else{let l=n-c;switch(r=i>.5?l/(2-n-c):l/(n+c),n){case e:a=(t-o)/l+(t<o?6:0);break;case t:a=(o-e)/l+2;break;case o:a=(e-t)/l+4;break;default:throw new Error}a/=6}return[a,r,i]}(o,a,r).map(e=>Math.round(100*e));return`H${n} S${c} L${i}`;case"HEX":default:return e.hexColor}}function a(e,t){const a=null!=e.color,r=null!=e.colorTextType;if(t.hidden=!a,a){const{textColor:a,color:n}=e.color;t.style.backgroundColor=n,r&&(t.style.color=a,t.querySelector(".swatch-text").textContent=o({colorTextType:e.colorTextType,hexColor:n}))}}const r=new Map(Object.entries({vibrant:"vibrant",darkVibrant:"dark-vibrant",lightVibrant:"light-vibrant",muted:"muted",darkMuted:"dark-muted",lightMuted:"light-muted"}));function n(e,t){const{colors:o,colorTextType:n}=e;for(const[e,c]of r){const r=t.querySelector(".swatch."+c);a({colorTextType:n,color:null!=o?o[e]:void 0},r)}}function c(e,t){t.src=e.imgSrc,t.alt=e.name}const i=document.querySelector("#grid-items"),l=document.querySelector("#grid-item-template");const s=document.querySelector("#back");const d=document.querySelector("#palette"),u=d.querySelector("img.preview"),m=document.querySelector("#color-display"),p="Color Breakdown";function f(){d.classList.remove("is-open"),history.replaceState(!1,p,"."),document.title=p}let y=void 0;function h(e){y&&m.removeEventListener("change",y);const t=m.value;if(function(e){e.firstLoad?s.dataset.firstload="firstload":delete s.dataset.firstload}(e),e.data){function o(){n({...e.data,colorTextType:t},d)}o(),c(e.data,u),m.addEventListener("change",o),y=o,d.classList.add("is-open");const a=`${e.data.name} | ${p}`;document.title=a,e.updateHash&&history.replaceState(!0,a,"#"+e.data.timestamp)}else n({colors:void 0,colorTextType:t},d),c({imgSrc:"img/placeholder.svg",name:"No image"},u),y=void 0,f()}function v(t){switch(console.log(t.type,t.payload),t.type){case"ADD":return void function(t){const o=document.createDocumentFragment();for(const a of t.items){const t=document.importNode(l.content,!0);c(a,t.querySelector("img.preview")),n({...a,colorTextType:void 0},t);const r=t.querySelector("a");r.id="i"+a.timestamp,r.href="#i"+a.timestamp,t.querySelector("img").addEventListener("load",e),o.appendChild(t)}i.appendChild(o)}({items:t.payload});case"REMOVE":return void{timestamps:t.payload}.timestamps.forEach(e=>{const t=document.querySelector("#i"+e),o=null==t?void 0:t.parentElement;o&&i.removeChild(o)});case"DISPLAY":return void h({data:t.payload.entry,firstLoad:t.payload.firstLoad,updateHash:t.payload.updateHash});case"ERROR":return void console.error(t.payload)}}const g=import("../lib/node-vibrant/vibrant.js");async function b({name:e,url:t}){const{default:o}=await g,a=await o.from(t).getPalette();function r(e){if(e)return{color:e.getHex(),textColor:e.getBodyTextColor()}}return{timestamp:Date.now(),colors:{vibrant:r(a.Vibrant),darkVibrant:r(a.DarkVibrant),lightVibrant:r(a.LightVibrant),muted:r(a.Muted),darkMuted:r(a.DarkMuted),lightMuted:r(a.LightMuted)},imgSrc:t,name:e}}const L={passive:!0},S=new Worker("js/db-worker.js");function w(e){S.postMessage(e)}function x(){return location.hash.startsWith("#i")?parseInt(location.hash.slice("#i".length),10):void 0}const E=document.querySelector("#new-palette-entry"),k=E.elements.namedItem("imagefile");async function T(){w({type:"SAVE",payload:await function(e){const t=Array.from(e||[]).filter(e=>null!=e.type.match(/^image\//)).map(e=>({name:e.name,url:URL.createObjectURL(e)}));return Promise.all(t.map(b))}(k.files)})}function q(e){const t=x();null!=t&&w({type:"OPEN",payload:{timestamp:t,firstLoad:e}})}q(!0),window.addEventListener("hashchange",()=>q(!1)),S.addEventListener("message",e=>v(e.data)),document.querySelector(".palette-image").addEventListener("load",e),document.querySelector("#back").addEventListener("click",(function(){s.dataset.firstload||history.back(),f()}),L),document.querySelector("#delete").addEventListener("click",()=>{const e=x();null!=e&&w({type:"DELETE",payload:{timestamp:e,current:!0}})},L),document.querySelector(".palette-colors").addEventListener("click",(async function(e){const o=e.target.closest("button.swatch"),a=o&&o.querySelector(".swatch-text"),r=a&&a.textContent;if(r){const e=await t;await e.writeText(r)}}),L),E.addEventListener("submit",e=>{e.preventDefault(),T()}),k.addEventListener("change",T,L),k.addEventListener("focus",()=>k.classList.add("focus"),L),k.addEventListener("blur",()=>k.classList.remove("focus"),L),import("../lib/insights.js").then(e=>{e.init("BRUajm5Rl0FGGGhk"),e.trackPages()});
//# sourceMappingURL=index.js.map
